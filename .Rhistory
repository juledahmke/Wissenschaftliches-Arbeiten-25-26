load("~/GitHub/Wissenschaftliches-Arbeiten-25-26/titanic_clean.RData")
#Aufgabe 2
# Charlotte
#i)
Metrische_Variablen <- function(data, var) {
if(!var %in% names(data)) {
stop("Variable ecistiert nicht im Datensatz.")
#Existenz der Variable prüfen
}
x <- data[[var]]
if(!is.numeric(x)) {
stop("Variable ist nicht metrisch.")
# Prüfen, ob metrisch
}
result <- data.frame(
Variable = var,
N = sum(!is.na(x)),
Missing = sum(is.na(x)),
Mean = mean(x, na.rm = TRUE),
Median = median(x, na.rm = TRUE),
standarddeviation = sd(x, na.rm = TRUE),
Variance = var(x, na.rm = TRUE),
Minimum = min(x, na.rm = TRUE),
Maximum = max(x, na.rm = TRUE),
Q1 = quantile(x, 0.25, na.rm = TRUE),
Q3 = quantile(x, 0.75, na.rm = TRUE),
Range = max(x, na.rm = TRUE) - min(x, na.rm = TRUE)
)
return(result)
}
###############################################################################
# Hanna
# ii.
# Eine Funktion, die verschiedene geeignete deskriptive Statistiken für
# kategoriale Variablen berechnet und ausgibt
kategoriale_Variablen <- function(x) {
if (!is.factor(x) && !is.character(x)) {
stop("Variable ist nicht vom faktor- oder character-typ")
}
# Prüfen ob Variable entweder factor oder character ist.
# Fehlermeldung wenn Variable kein factor oder character ist.
x <- as.factor(x)
abs_freq <- table(x, useNA = "ifany")
# Gibt die absoluten Häufigkeiten an. Bei vorhandenen NAs werden diese in
# einer eigenen Katerogie gezählt.
rel_freq <- prop.table(abs_freq)
# Rechnet die relativen Häufigkeiten aus.
modus <- names(abs_freq)[which.max(abs_freq)]
# Gibt den Modus an
n_kategorien <- nlevels(x)
# Gibt an wie viele Kategorien es in den jeweiligen "Merkmalen" gibt
na_anteil <- mean(is.na(x))
# Ermittelt den Anteil der NAs
return(list(
absolute_haeufigkeiten = abs_freq,
relative_haeufigkeiten = rel_freq,
modus = modus,
anzahl_kategorien = n_kategorien,
na_anteil = na_anteil
))
# Gibt die Ergebnisse in einer Liste zurück.
}
Ueberlebt <- Titanic_1$Survived
Klassen <- Titanic_1$Pclass
Geschlecht <- Titanic_1$Sex
Hafen <- Titanic_1$Embarked
Titel <- Titanic_1$Title
Schiffsseite <- Titanic_1$Side
Deck <- Titanic_1$Deck
# Neue Zuordnung der kategorialen Variablen, für einfachere Nutzung der Funktion.
kategoriale_Variablen(Ueberlebt)
# Ausgabe der Endergebnisse zur jeweiligen Variable (z.B."Überlebt")
# Jule
# iii
# Deskriptive bivariate Statistiken für den Zusammenhang
# zwischen zwei kategorialen Variablen
# Nutzung der Hilsfunktion aus Skript 2 um Skalenniveau zu bestimmen,
# um zu überprüfen, welche Verwendung der Funktionen sinnvoll ist
# Erstellung einer Kontigenztafel
Kontigenztafel <- function(x, y){
#Die Merkmale müssen an den gleichen Merkmalsträgern erhoben sein,
#somit muss die Länge übereinstimmen
#Umgang mit NAs: Merkmalsträger mit fehlenden Werten werden nicht aufgeführt
if(length(x) != length(y))
return("x und y müssen dieselbe Länge haben")
else{Tabelle <- addmargins(table(x, y))
if(any(is.na(x) , is.na(y)))
return(list("Auf Grund fehlender Werte werden nicht alle Merkmalsträger aufgeführt",
Tabelle))
else{Tabelle <- table(x, y)
Kontigenz <- addmargins(Tabelle)
print(Kontigenz)}}
}
#Berechnung der Korrelation für zwei ordinal skalierte Merkmale
Korrelation <- function(x, y){if(!is.ordered(x) | !is.ordered(y))
return("x und y müssen ordinal skaliert sein")
else{cor(as.numeric(x), as.numeric(y) , use = "complete.obs", method = "spearman")}
}
###################################################
## Kimia
## iv: Eine Funktion, die geeignete deskriptive bivariate Statistiken
##     für den Zusammenhang zwischen einer metrischen und einer dichotomen
##     Variablen berechnet und ausgibt
analyze_metric_dichotomous <- function(metric_var, dichotomous_var, data) {
# 1. Datenbereinigung: Zeilen mit NAs in den relevanten Variablen entfernen
# Dies stellt sicher, dass aggregate und boxplot korrekt funktionieren.
clean_data <- data[!is.na(data[[metric_var]]) & !is.na(data[[dichotomous_var]]), ]
# 2. Berechnung der deskriptiven Statistiken pro Gruppe
# Erstellung einer Formel für dynamische Variablennamen
formula_str <- as.formula(paste(metric_var, "~", dichotomous_var))
# Berechnung von Mittelwert, Standardabweichung und Median
stats <- aggregate(formula_str,
data = clean_data,
FUN = function(x) c(Mean = mean(x), SD = sd(x), Median = median(x)))
# Umwandlung des Matrix-Ergebnisses in einen sauberen Dataframe
stats <- do.call(data.frame, stats)
# Spaltennamen für die Ausgabe optimieren
colnames(stats) <- c(dichotomous_var, "Mean", "SD", "Median")
# Ausgabe der Tabelle in der Konsole
print("Deskriptive Statistik pro Gruppe:")
print(stats)
# 3. Visualisierung mittels Boxplot
# Ein Boxplot ist ideal, um die Verteilung einer metrischen Variable
# über zwei Gruppen hinweg zu vergleichen.
boxplot(formula_str,
data = clean_data,
main = paste("Vergleich von", metric_var, "nach", dichotomous_var),
xlab = dichotomous_var,
ylab = metric_var,
col = c("steelblue", "tomato"), # Farben für die Gruppen
pch = 19) # Ausreißer als ausgefüllte Punkte darstellen
}
#########################################################################
## Samuel
## v)
## Erstellung einer Funktion zur Visualisierung von drei/vier
## kategoriellen Variablen
mosaic_kat <- function(data, variab) {
if(length(variab) < 3 || length(variab) > 4) {
stop("Es dürfen nur 3 oder 4 Variablen sein")
}
if(!all(variab %in% names(data))) {
stop("Mindestens eine Variable existiert nicht im Datensatz")
}
if(!all(sapply(data[variab], function(x) is.factor(x) || is.character(x)))) {
stop("Variablen müssen nominal oder ordinal skaliert sein")
}
# Mosaicplot
mosaicplot(table(data[variab]),
main = paste("Mosaicplot:", paste(variab, collapse = " × ")),
color = TRUE, las = 1)
}
Metrische_Variablen(Titanic_1, "Age")
Metrische_Variablen <- function(data, var) {
if(!var %in% names(data)) {
stop("Variable ecistiert nicht im Datensatz.")
#Existenz der Variable prüfen
}
x <- data[[var]]
if(!is.numeric(x)) {
stop("Variable ist nicht metrisch.")
# Prüfen, ob metrisch
}
result <- data.frame(
Variable = var,
N = sum(!is.na(x)),
Missing = sum(is.na(x)),
Mean = mean(x, na.rm = TRUE),
Median = median(x, na.rm = TRUE),
standarddeviation = sd(x, na.rm = TRUE),
Variance = var(x, na.rm = TRUE),
Minimum = min(x, na.rm = TRUE),
Maximum = max(x, na.rm = TRUE),
#Q1 = quantile(x, 0.25, na.rm = TRUE),
#Q3 = quantile(x, 0.75, na.rm = TRUE),
Range = max(x, na.rm = TRUE) - min(x, na.rm = TRUE)
)
return(result)
}
Metrische_Variablen(Titanic_1, "Age")
Metrische_Variablen <- function(data, var) {
if(!var %in% names(data)) {
stop("Variable ecistiert nicht im Datensatz.")
#Existenz der Variable prüfen
}
x <- data[[var]]
if(!is.numeric(x)) {
stop("Variable ist nicht metrisch.")
# Prüfen, ob metrisch
}
result <- data.frame(
Variable = var,
N = sum(!is.na(x)),
Missing = sum(is.na(x)),
Mean = mean(x, na.rm = TRUE),
Median = median(x, na.rm = TRUE),
standarddeviation = sd(x, na.rm = TRUE),
Variance = var(x, na.rm = TRUE),
Minimum = min(x, na.rm = TRUE),
Maximum = max(x, na.rm = TRUE),
#Q1 = quantile(x, 0.25, na.rm = TRUE),
#Q3 = quantile(x, 0.75, na.rm = TRUE),
#Range = max(x, na.rm = TRUE) - min(x, na.rm = TRUE)
)
return(result)
}
Metrische_Variablen(Titanic_1, "Age")
Metrische_Variablen <- function(data, var) {
if(!var %in% names(data)) {
stop("Variable ecistiert nicht im Datensatz.")
#Existenz der Variable prüfen
}
x <- data[[var]]
if(!is.numeric(x)) {
stop("Variable ist nicht metrisch.")
# Prüfen, ob metrisch
}
result <- data.frame(
Variable = var,
N = sum(!is.na(x)),
Missing = sum(is.na(x)),
Mean = mean(x, na.rm = TRUE),
Median = median(x, na.rm = TRUE),
standarddeviation = sd(x, na.rm = TRUE),
Variance = var(x, na.rm = TRUE),
Minimum = min(x, na.rm = TRUE),
Maximum = max(x, na.rm = TRUE)#,
#Q1 = quantile(x, 0.25, na.rm = TRUE),
#Q3 = quantile(x, 0.75, na.rm = TRUE),
#Range = max(x, na.rm = TRUE) - min(x, na.rm = TRUE)
)
return(result)
}
Metrische_Variablen(Titanic_1, "Age")
Metrische_Variablen <- function(data, var) {
if(!var %in% names(data)) {
stop("Variable ecistiert nicht im Datensatz.")
#Existenz der Variable prüfen
}
x <- data[[var]]
if(!is.numeric(x)) {
stop("Variable ist nicht metrisch.")
# Prüfen, ob metrisch
}
result <- data.frame(
Variable = var,
N = sum(!is.na(x)),
Missing = sum(is.na(x)),
Mean = mean(x, na.rm = TRUE),
Median = median(x, na.rm = TRUE),
standarddeviation = sd(x, na.rm = TRUE),
Variance = var(x, na.rm = TRUE),
Minimum = min(x, na.rm = TRUE),
Maximum = max(x, na.rm = TRUE),
#Q1 = quantile(x, 0.25, na.rm = TRUE),
#Q3 = quantile(x, 0.75, na.rm = TRUE),
#Range = max(x, na.rm = TRUE) - min(x, na.rm = TRUE)
)
return(result)
}
Metrische_Variablen(Titanic_1, "Age")
Metrische_Variablen <- function(data, var) {
if(!var %in% names(data)) {
stop("Variable ecistiert nicht im Datensatz.")
#Existenz der Variable prüfen
}
x <- data[[var]]
if(!is.numeric(x)) {
stop("Variable ist nicht metrisch.")
# Prüfen, ob metrisch
}
result <- data.frame(
Variable = var,
N = sum(!is.na(x)),
Missing = sum(is.na(x)),
Mean = mean(x, na.rm = TRUE),
Median = median(x, na.rm = TRUE),
standarddeviation = sd(x, na.rm = TRUE),
Variance = var(x, na.rm = TRUE),
Minimum = min(x, na.rm = TRUE),
Maximum = max(x, na.rm = TRUE),
#Q1 = quantile(x, 0.25, na.rm = TRUE),
#Q3 = quantile(x, 0.75, na.rm = TRUE),
Range = max(x, na.rm = TRUE) - min(x, na.rm = TRUE)
)
return(result)
}
Metrische_Variablen(Titanic_1, "Age")
Metrische_Variablen <- function(data, var) {
if(!var %in% names(data)) {
stop("Variable ecistiert nicht im Datensatz.")
#Existenz der Variable prüfen
}
x <- data[[var]]
if(!is.numeric(x)) {
stop("Variable ist nicht metrisch.")
# Prüfen, ob metrisch
}
result <- data.frame(
Variable = var,
N = sum(!is.na(x)),
Missing = sum(is.na(x)),
Mean = mean(x, na.rm = TRUE),
Median = median(x, na.rm = TRUE),
standarddeviation = sd(x, na.rm = TRUE),
Variance = var(x, na.rm = TRUE),
Minimum = min(x, na.rm = TRUE),
Maximum = max(x, na.rm = TRUE),
Q1 = quantile(x, 0.25, na.rm = TRUE),
#Q3 = quantile(x, 0.75, na.rm = TRUE),
Range = max(x, na.rm = TRUE) - min(x, na.rm = TRUE)
)
return(result)
}
Metrische_Variablen(Titanic_1, "Age")
?quantile
quantile(Titanic_1[["Age"]])
quantile(Titanic_1[["Age"]], o.25)
quantile(Titanic_1[["Age"]], 0.25)
Metrische_Variablen <- function(data, var) {
if(!var %in% names(data)) {
stop("Variable ecistiert nicht im Datensatz.")
#Existenz der Variable prüfen
}
x <- data[[var]]
if(!is.numeric(x)) {
stop("Variable ist nicht metrisch.")
# Prüfen, ob metrisch
}
result <- data.frame(
Variable = var,
N = sum(!is.na(x)),
Missing = sum(is.na(x)),
Mean = mean(x, na.rm = TRUE),
Median = median(x, na.rm = TRUE),
standarddeviation = sd(x, na.rm = TRUE),
Variance = var(x, na.rm = TRUE),
Minimum = min(x, na.rm = TRUE),
Maximum = max(x, na.rm = TRUE),
quantile(x, 0.25, na.rm = TRUE),
#Q3 = quantile(x, 0.75, na.rm = TRUE),
Range = max(x, na.rm = TRUE) - min(x, na.rm = TRUE)
)
return(result)
}
Metrische_Variablen(Titanic_1, "Age")
Metrische_Variablen <- function(data, var) {
if(!var %in% names(data)) {
stop("Variable ecistiert nicht im Datensatz.")
#Existenz der Variable prüfen
}
x <- data[[var]]
if(!is.numeric(x)) {
stop("Variable ist nicht metrisch.")
# Prüfen, ob metrisch
}
result <- data.frame(
Variable = var,
N = sum(!is.na(x)),
Missing = sum(is.na(x)),
Mean = mean(x, na.rm = TRUE),
Median = median(x, na.rm = TRUE),
standarddeviation = sd(x, na.rm = TRUE),
Variance = var(x, na.rm = TRUE),
Minimum = min(x, na.rm = TRUE),
Maximum = max(x, na.rm = TRUE),
Q1 = quantile(x, 0.25, na.rm = TRUE),
#Q3 = quantile(x, 0.75, na.rm = TRUE),
Range = max(x, na.rm = TRUE) - min(x, na.rm = TRUE)
)
return(result)
}
Metrische_Variablen(Titanic_1, "Age")
quantile(Titanic_1[["Age"]], 0.25)
as.numeric(quantile(Titanic_1[["Age"]], 0.25))
Metrische_Variablen <- function(data, var) {
if(!var %in% names(data)) {
stop("Variable ecistiert nicht im Datensatz.")
#Existenz der Variable prüfen
}
x <- data[[var]]
if(!is.numeric(x)) {
stop("Variable ist nicht metrisch.")
# Prüfen, ob metrisch
}
result <- data.frame(
Variable = var,
N = sum(!is.na(x)),
Missing = sum(is.na(x)),
Mean = mean(x, na.rm = TRUE),
Median = median(x, na.rm = TRUE),
standarddeviation = sd(x, na.rm = TRUE),
Variance = var(x, na.rm = TRUE),
Minimum = min(x, na.rm = TRUE),
Maximum = max(x, na.rm = TRUE),
Q1 = as.numeric(quantile(x, 0.25, na.rm = TRUE)),
Q3 = as.numeric(quantile(x, 0.75, na.rm = TRUE)),
Range = max(x, na.rm = TRUE) - min(x, na.rm = TRUE)
)
return(result)
}
Metrische_Variablen(Titanic_1, "Age")
Metrische_Variablen <- function(data, var) {
if(!var %in% names(data)) {
stop("Variable ecistiert nicht im Datensatz.")
#Existenz der Variable prüfen
}
x <- data[[var]]
if(!is.numeric(x)) {
stop("Variable ist nicht metrisch.")
# Prüfen, ob metrisch
}
result <- data.frame(
Variable = var,
N = sum(!is.na(x)),
Missing = sum(is.na(x)),
Mean = mean(x, na.rm = TRUE),
Median = median(x, na.rm = TRUE),
standarddeviation = sd(x, na.rm = TRUE),
Variance = var(x, na.rm = TRUE),
Minimum = min(x, na.rm = TRUE),
Maximum = max(x, na.rm = TRUE),
Q25 = as.numeric(quantile(x, 0.25, na.rm = TRUE)),
Q75 = as.numeric(quantile(x, 0.75, na.rm = TRUE)),
Range = max(x, na.rm = TRUE) - min(x, na.rm = TRUE)
)
return(result)
}
Metrische_Variablen(Titanic_1, "Age")
Metrische_Variablen(Titanic_1, "Age")
View(analyze_metric_dichotomous)
View(Titanic_1)
Metrische_Variablen(Titanic_1, "Fare")
kategoriale_Variablen(Titanic_1$Sex)
kategoriale_Variablen(Titanic_1$Embarked)
kategoriale_Variablen(Titanic_1$Survived)
Kontigenztafel(Titanic_1$Survived, Titanic_1$Sex)
Kontigenztafel(Titanic_1$Survived, Titanic_1$Pclass)
Kontigenztafel(Titanic_1$Sex, Titanic_1$Pclass)
Kontigenztafel(Titanic_1$Pclass, Titanic_1$SibSp)
Korrelation(Titanic_1$Fare, Titanic_1$Pclass)
